<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consola de Seguridad IoT - ITP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="imagen/favicon.png">
</head>
<body class="bg-light">

    <nav class="navbar navbar-dark bg-dark mb-4 shadow">
        <div class="container">
            <span class="navbar-brand fw-bold">SISTEMA DE GESTI√ìN DE ACCESOS CR√çTICOS </span>
        </div>
    </nav>

    <div class="container">
        <ul class="nav nav-pills nav-fill mb-4 shadow-sm bg-white rounded p-1" id="pills-tab" role="tablist">
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#admin">1. ADMINISTRACI√ìN (CRUD)</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#control">2. PANEL DE AUTORIZACI√ìN</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#monitoreo">3. MONITOREO PERIMETRAL</button></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane fade show active" id="admin">
                <div class="card p-3 mb-3 shadow-sm border-0">
                    <h5 class="text-secondary">Registrar Punto de Acceso Restringido</h5>
                    <div class="row g-2">
                        <div class="col-md-5"><input type="text" id="nombreP" class="form-control" placeholder="Nombre (ej. Almac√©n de Valores)"></div>
                        <div class="col-md-5"><input type="text" id="ubicacionP" class="form-control" placeholder="Ubicaci√≥n (ej. Planta 1)"></div>
                        <div class="col-md-2"><button class="btn btn-primary w-100" onclick="crearPuerta()">Registrar</button></div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-white shadow-sm rounded">
                        <thead class="table-dark">
                            <tr><th>Dispositivo</th><th>Ubicaci√≥n</th><th>Acciones</th></tr>
                        </thead>
                        <tbody id="tablaAdmin"></tbody>
                    </table>
                </div>
            </div>

            <div class="tab-pane fade" id="control">
                <div class="row mb-4 justify-content-center">
                    <div class="col-md-6">
                        <div class="input-group shadow-sm">
                            <span class="input-group-text bg-white border-end-0">üîç</span>
                            <input type="text" id="buscadorPuertas" class="form-control border-start-0" 
                                   placeholder="Buscar punto de acceso..." onkeyup="filtrarPuertas()">
                        </div>
                    </div>
                </div>
                <div class="row" id="contenedorControl"></div>
            </div>

            <div class="tab-pane fade" id="monitoreo">
                <div class="row mb-4" id="contenedorGrafico"></div>
                <h5 class="text-secondary">Bit√°cora Global de Accesos</h5>
                <div class="table-responsive">
                    <table class="table table-sm table-striped bg-white shadow-sm align-middle text-center">
                        <thead class="table-secondary">
                            <tr><th>Dispositivo</th><th>Estatus</th><th>Autonom√≠a</th><th>Fecha</th><th>Apertura</th><th>Cierre</th></tr>
                        </thead>
                        <tbody id="tablaMonitoreo"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalDetalle" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content shadow-lg border-0">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title fw-bold" id="tituloModal">Auditor√≠a de Acceso</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-between mb-3 bg-light p-2 rounded border">
                        <p class="mb-0 text-success fw-bold small">Autorizaciones: <span id="contadorAperturas">0</span></p>
                        <p class="mb-0 text-danger fw-bold small">Cierres seguros: <span id="contadorCierres">0</span></p>
                    </div>
                    <table class="table table-hover text-center small">
                        <thead class="table-dark">
                            <tr><th>Fecha</th><th>Apertura</th><th>Cierre</th></tr>
                        </thead>
                        <tbody id="cuerpoTablaDetalle"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalEditar" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title fw-bold">Modificar Punto de Acceso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editId">
                    <div class="mb-3">
                        <label class="form-label fw-bold">Nombre del Dispositivo</label>
                        <input type="text" id="editNombre" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Nueva Ubicaci√≥n</label>
                        <input type="text" id="editUbicacion" class="form-control">
                    </div>
                    <button class="btn btn-dark w-100 fw-bold" onclick="guardarCambios()">ACTUALIZAR DATOS</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>